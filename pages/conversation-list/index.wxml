<!-- pages/conversation-list/index.wxml -->
<view class="page">
  <view class="conversation-list">
    <view 
      class="conversation-item" 
      wx:for="{{conversationList}}" 
      wx:key="id"
      bindtap="onConversationTap"
      data-id="{{item.id}}">
      
      <!-- 头像 -->
      <image 
        class="avatar" 
        src="{{item.otherUser.avatarUrl || '/assets/tabbar/profile.png'}}" 
        mode="aspectFill"></image>
      
      <!-- 内容区域 -->
      <view class="content">
        <view class="header">
          <text class="name">{{item.otherUser.nickname || '未知用户'}}{{item.orderNo ? ' ' + item.orderNo : ''}}</text>
          <text class="time">{{item.lastMessageTimeFormatted}}</text>
        </view>
        <view class="footer">
          <text class="message {{item.unreadCount > 0 ? 'unread' : ''}}">{{item.lastMessagePreview || '暂无消息'}}</text>
          <view class="badge" wx:if="{{item.unreadCount > 0}}">{{item.unreadCount > 99 ? '99+' : item.unreadCount}}</view>
        </view>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view class="empty" wx:if="{{!loading && conversationList.length === 0}}">
      <text>暂无会话</text>
    </view>
  </view>
  
  <!-- 加载中 -->
  <view class="loading" wx:if="{{loading}}">
    <text>加载中...</text>
  </view>
</view>
